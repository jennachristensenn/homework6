<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jenna Christensen">

<title>Advanced Function Writing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced Function Writing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jenna Christensen </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'jsonlite'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<section id="task-1-conceptual-questions" class="level2">
<h2 class="anchored" data-anchor-id="task-1-conceptual-questions">Task 1: Conceptual Questions</h2>
<ol type="1">
<li>What is the purpose of the lapply() function? What is the equivalent purrr function?</li>
</ol>
<blockquote class="blockquote">
<p>To apply a function to every element of a list, The equivalent in purrr is map().</p>
</blockquote>
<ol start="2" type="1">
<li>Suppose we have a list called my_list. Each element of the list is a numeric data frame (all columns are numeric). We want use lapply() to run the code cor(numeric_matrix, method = “kendall”) on each element of the list. Write code to do this below!</li>
</ol>
<blockquote class="blockquote">
<p>lapply(my_list, function(numeric_matrix) { cor(numeric_matrix, method = “kendall”)})</p>
</blockquote>
<ol start="3" type="1">
<li><ol start="3" type="1">
<li>What are two advantages of using purrr functions instead of the BaseR apply family?</li>
</ol></li>
</ol>
<blockquote class="blockquote">
<p>Base R has syntax inconsistencies and purr provides more functionality while also being cleaner.</p>
</blockquote>
<ol start="4" type="1">
<li>What is a side-effect function?</li>
</ol>
<blockquote class="blockquote">
<p>It changes the state of something such as printing out data or plotting. It does not transform the data, it produces something.</p>
</blockquote>
<ol start="5" type="1">
<li>Why can you name a variable sd in a function and not cause any issues with the sd function?</li>
</ol>
<blockquote class="blockquote">
<p>A temporary function environment is created when a function is called.</p>
</blockquote>
</section>
<section id="task-2-writing-r-functions" class="level2">
<h2 class="anchored" data-anchor-id="task-2-writing-r-functions">Task 2: Writing R Functions</h2>
<p>RMSE function that takes in a vector of responses and predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>getRMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(resp, pred, ...){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  clean <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(resp)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((resp[clean] <span class="sc">-</span> pred[clean])<span class="sc">^</span><span class="dv">2</span>, ...))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rmse)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creating response values and predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(resp <span class="sc">~</span> x), <span class="fu">data.frame</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Testing RMSE function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with original values</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="ot">&lt;-</span> <span class="fu">getRMSE</span>(resp, pred)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9581677</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with na values without ... included</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>resp[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>test_rmse1 <span class="ot">&lt;-</span> <span class="fu">getRMSE</span>(resp, pred)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_rmse1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9604273</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with na values with ... included</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test_rmse2 <span class="ot">&lt;-</span> <span class="fu">getRMSE</span>(resp, pred, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_rmse2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9604273</code></pre>
</div>
</div>
<p>MAE function that takes in a vector of responses and predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>getMAE <span class="ot">&lt;-</span> <span class="cf">function</span>(resp, pred, ...){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  clean <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(resp)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(resp[clean] <span class="sc">-</span> pred[clean]), ...)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mae)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creating response values and predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(resp <span class="sc">~</span> x), <span class="fu">data.frame</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Testing MAE function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with original values</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>test_mae <span class="ot">&lt;-</span> <span class="fu">getMAE</span>(resp, pred)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_mae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8155776</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with na values without ... included</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>resp[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>test_mae1 <span class="ot">&lt;-</span> <span class="fu">getMAE</span>(resp, pred)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_mae1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8178064</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with na values with ... included</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>test_mae2 <span class="ot">&lt;-</span> <span class="fu">getMAE</span>(resp, pred, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_mae2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8178064</code></pre>
</div>
</div>
<p>Creating a wrapper function using the above as helper functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>common_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(resp, pred, <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">"RMSE"</span>, <span class="st">"MAE"</span>), ...){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(resp) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.atomic</span>(resp) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.vector</span>(resp)) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"'resp' argument must be a numeric atomic vector"</span>)}</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(pred) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.atomic</span>(pred) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.vector</span>(pred)) {</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"'pred' argument must be a numeric atomic vector"</span>)}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"RMSE"</span> <span class="sc">%in%</span> metrics) {</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>RMSE <span class="ot">&lt;-</span> <span class="fu">getRMSE</span>(resp, pred, ...)}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"MAE"</span> <span class="sc">%in%</span> metrics) {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>MAE <span class="ot">&lt;-</span> <span class="fu">getMAE</span>(resp, pred, ...)}</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creating response values and predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(resp <span class="sc">~</span> x), <span class="fu">data.frame</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Testing wrapper function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing rmse individually</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>test_metrics_rmse <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred, <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9581677</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing mae individually</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>test_metrics_mae <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred, <span class="at">metrics =</span> <span class="st">"MAE"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_mae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 0.8155776</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing default values (both)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>test_metrics_default <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9581677

$MAE
[1] 0.8155776</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>resp[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># testing rmse individually with na</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>test_metrics_rmse1 <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred, <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_rmse1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9604273</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing mae individually with na</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>test_metrics_mae1 <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred, <span class="at">metrics =</span> <span class="st">"MAE"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_mae1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 0.8178064</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing default values (both) with na</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>test_metrics_default1 <span class="ot">&lt;-</span> <span class="fu">common_metrics</span>(resp, pred)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_metrics_default1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9604273

$MAE
[1] 0.8178064</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing with invalid data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">#test_metrics &lt;- common_metrics(resp, pred)</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_metrics)</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># couldn't get the above to still render and show that an error was caught</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>test_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">common_metrics</span>(resp, pred)  </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Error caught: "</span>, e<span class="sc">$</span>message)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">test_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Error caught: 'resp' argument must be a numeric atomic vector</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result) <span class="co"># print null with an error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="task-3-querying-an-api-and-a-tidy-style-function" class="level2">
<h2 class="anchored" data-anchor-id="task-3-querying-an-api-and-a-tidy-style-function">Task 3: Querying an API and a Tidy-Style Function</h2>
<p>Using the API to retrieve information about Tesla</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>api <span class="ot">&lt;-</span> <span class="st">"https://newsapi.org/v2/everything?q="</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>topic <span class="ot">&lt;-</span> <span class="st">"tesla"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="st">"10e41a08fc9c4984a281f00cc24ffaef"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>from_date <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">30</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>url_str <span class="ot">&lt;-</span> <span class="fu">paste0</span>(api, topic, <span class="st">"&amp;from="</span>, <span class="fu">format</span>(from_date, <span class="st">"%Y-%m-%d"</span>), <span class="st">"&amp;apiKey="</span>, key)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(url_str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://newsapi.org/v2/everything?q=tesla&amp;from=2024-09-16&amp;apiKey=10e41a08fc9c4984a281f00cc24ffaef"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>tesla_info <span class="ot">&lt;-</span> <span class="fu">GET</span>(url_str) <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">content</span>(<span class="st">"text"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fromJSON</span>(<span class="at">flatten =</span> <span class="cn">TRUE</span>, <span class="at">simplifyDataFrame =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"articles"</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tesla_info) <span class="co">#was not getting a list for my first col</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  9 variables:
 $ author     : chr  NA "Kevin Purdy, Ars Technica" "Aarian Marshall" "Andrew J. Hawkins" ...
 $ title      : chr  "[Removed]" "I Own a Chevy Bolt, and Superchargers Are a Total Game Changer" "Tesla Is Ready to Roll Out the Cybercab, Its Answer to Robotaxis" "Tesla Cybercab announced: Elon Musk’s robotaxi is finally here" ...
 $ description: chr  "[Removed]" "The anxiety of longer trips in my EV has eased considerably now that I can use Tesla Supercharger stations." "On Thursday, Tesla will reveal its Cybercab, a self-driving robotaxi. But running an autonomous ride-hailing fl"| __truncated__ "Tesla CEO Elon Musk unveiled the long-awaited prototype robotaxi at an event in Los Angeles. But questions rema"| __truncated__ ...
 $ url        : chr  "https://removed.com" "https://www.wired.com/story/i-own-a-chevy-bolt-and-superchargers-are-a-total-game-changer/" "https://www.wired.com/story/tesla-is-ready-to-roll-out-cybercab-robotaxi/" "https://www.theverge.com/2024/10/10/24265530/tesla-robotaxi-elon-musk-features-range-price-release-date" ...
 $ urlToImage : chr  NA "https://media.wired.com/photos/67004d2a6602ed7227d3fcae/191:100/w_1280,c_limit/Gear_Chevy_Bolt_GettyImages-1962772373.jpg" "https://media.wired.com/photos/670573800d28edd6a8566d13/191:100/w_1280,c_limit/tesla-cybercab-gear-1167397052.jpg" "https://cdn.vox-cdn.com/thumbor/fBs9y8RUB3-qwqpgYcORgqbrDfs=/0x0:2560x1440/1200x628/filters:focal(1280x720:1281"| __truncated__ ...
 $ publishedAt: chr  "2024-10-02T21:27:56Z" "2024-10-04T22:04:17Z" "2024-10-09T12:30:00Z" "2024-10-11T02:59:05Z" ...
 $ content    : chr  "[Removed]" "It should not be so exciting to eat a breakfast quesadilla in your car.\r\nBut this quesadilla was from Wawa, t"| __truncated__ "On Thursday evening, around 7 pm PDT, Tesla is slated to unveil the newest vehicle in its lineup: one that will"| __truncated__ "Tesla Cybercab announced: Elon Musks robotaxi is finally here\r\nTesla Cybercab announced: Elon Musks robotaxi "| __truncated__ ...
 $ source.id  : chr  NA "wired" "wired" "the-verge" ...
 $ source.name: chr  "[Removed]" "Wired" "Wired" "The Verge" ...</code></pre>
</div>
</div>
<p>Function that allows user to query the API</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>news_api <span class="ot">&lt;-</span> <span class="cf">function</span>(topic, from_date, key) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    api <span class="ot">&lt;-</span> <span class="st">"https://newsapi.org/v2/everything?q="</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    url_str <span class="ot">&lt;-</span> <span class="fu">paste0</span>(api, <span class="fu">URLencode</span>(topic), <span class="st">"&amp;from="</span>, <span class="fu">format</span>(<span class="fu">as.Date</span>(from_date), <span class="st">"%Y-%m-%d"</span>), <span class="st">"&amp;apiKey="</span>, key)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    articles <span class="ot">&lt;-</span> <span class="fu">GET</span>(url_str) <span class="sc">|&gt;</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">content</span>(<span class="st">"text"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fromJSON</span>(<span class="at">flatten =</span> <span class="cn">TRUE</span>, <span class="at">simplifyDataFrame =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pluck</span>(<span class="st">"articles"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(articles) </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Getting data for two different topics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tesla_data <span class="ot">&lt;-</span> <span class="fu">news_api</span>(<span class="at">topic =</span> <span class="st">"tesla"</span>, from_date, key)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tesla_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     author
1                      &lt;NA&gt;
2 Kevin Purdy, Ars Technica
3           Aarian Marshall
4         Andrew J. Hawkins
5         Andrew J. Hawkins
6                      &lt;NA&gt;
                                                             title
1                                                        [Removed]
2   I Own a Chevy Bolt, and Superchargers Are a Total Game Changer
3 Tesla Is Ready to Roll Out the Cybercab, Its Answer to Robotaxis
4   Tesla Cybercab announced: Elon Musk’s robotaxi is finally here
5                         The bill finally comes due for Elon Musk
6                                                        [Removed]
                                                                                                                                                                    description
1                                                                                                                                                                     [Removed]
2                                                                   The anxiety of longer trips in my EV has eased considerably now that I can use Tesla Supercharger stations.
3 On Thursday, Tesla will reveal its Cybercab, a self-driving robotaxi. But running an autonomous ride-hailing fleet involves much more than teaching cars to drive themselves.
4                                 Tesla CEO Elon Musk unveiled the long-awaited prototype robotaxi at an event in Los Angeles. But questions remain about the vehicle’s safety.
5                            Tesla CEO Elon Musk is finally forced to stop hiding behind his bluster and show off a real autonomous vehicle. Anything less would be a disaster.
6                                                                                                                                                                     [Removed]
                                                                                                      url
1                                                                                     https://removed.com
2              https://www.wired.com/story/i-own-a-chevy-bolt-and-superchargers-are-a-total-game-changer/
3                               https://www.wired.com/story/tesla-is-ready-to-roll-out-cybercab-robotaxi/
4 https://www.theverge.com/2024/10/10/24265530/tesla-robotaxi-elon-musk-features-range-price-release-date
5   https://www.theverge.com/2024/10/9/24265781/tesla-robotaxi-elon-musk-claims-safety-driverless-level-5
6                                                                                     https://removed.com
                                                                                                                                                                                                   urlToImage
1                                                                                                                                                                                                        &lt;NA&gt;
2                                                                                   https://media.wired.com/photos/67004d2a6602ed7227d3fcae/191:100/w_1280,c_limit/Gear_Chevy_Bolt_GettyImages-1962772373.jpg
3                                                                                           https://media.wired.com/photos/670573800d28edd6a8566d13/191:100/w_1280,c_limit/tesla-cybercab-gear-1167397052.jpg
4              https://cdn.vox-cdn.com/thumbor/fBs9y8RUB3-qwqpgYcORgqbrDfs=/0x0:2560x1440/1200x628/filters:focal(1280x720:1281x721)/cdn.vox-cdn.com/uploads/chorus_asset/file/25670491/videoframe_3297637.png
5 https://cdn.vox-cdn.com/thumbor/UTFYAIWx1CsXE6oKzXfSIOu2rXQ=/0x0:2040x1360/1200x628/filters:focal(1020x680:1021x681)/cdn.vox-cdn.com/uploads/chorus_asset/file/25663397/STKE001_STK086_Tesla_Robotaxi_D.jpg
6                                                                                                                                                                                                        &lt;NA&gt;
           publishedAt
1 2024-10-02T21:27:56Z
2 2024-10-04T22:04:17Z
3 2024-10-09T12:30:00Z
4 2024-10-11T02:59:05Z
5 2024-10-09T14:38:07Z
6 2024-10-08T19:10:25Z
                                                                                                                                                                                                                        content
1                                                                                                                                                                                                                     [Removed]
2      It should not be so exciting to eat a breakfast quesadilla in your car.\r\nBut this quesadilla was from Wawa, this Wawa hosted a Tesla Supercharger, and this car was the 2023 Chevrolet Bolt EUV, hooked… [+6109 chars]
3        On Thursday evening, around 7 pm PDT, Tesla is slated to unveil the newest vehicle in its lineup: one that will be able to drive itself. A purpose-built Tesla robot taxia Cybercab, in the electric au… [+2713 chars]
4    Tesla Cybercab announced: Elon Musks robotaxi is finally here\r\nTesla Cybercab announced: Elon Musks robotaxi is finally here\r\n / Musk showed off a prototype of a self-driving car he calls the Cyberca… [+3285 chars]
5 Image: Cath Virginia / The Verge, Turbosquid\r\n\n \n\n\n The Tesla CEO has long promised — and failed to deliver —&nbsp;a fully autonomous vehicle. With this week’s robotaxi reveal, his time is up. For almost … [+16028 chars]
6                                                                                                                                                                                                                     [Removed]
  source.id source.name
1      &lt;NA&gt;   [Removed]
2     wired       Wired
3     wired       Wired
4 the-verge   The Verge
5 the-verge   The Verge
6      &lt;NA&gt;   [Removed]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>amazon_data <span class="ot">&lt;-</span> <span class="fu">news_api</span>(<span class="at">topic =</span> <span class="st">"amazon"</span>, from_date, key)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(amazon_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               author
1           Kris Holt
2     Jess Weatherbed
3         Joe Tilleli
4       Lawrence Bonk
5 Valentina Palladino
6           Jeff Dunn
                                                                                       title
1                                 Hundreds of Amazon drivers in NYC join the Teamsters union
2                              Amazon is stuffing generative AI into its shopping experience
3 Reduce Energy and Money with Amazon Smart Thermostat Now That 30% Off for Amazon Prime Day
4   Amazon tablets are getting AI tools, like writing assist and automatic website summaries
5                 The best early Amazon Prime Day deals to shop before October Big Deal Days
6           These Prime Day SSD deals are the best we found for Amazon October Big Deal Days
                                                                                                                                                                                                                                                               description
1 Hundreds of Amazon\r\n drivers in New York City have joined the Teamsters\r\n union in the hope of obtaining better pay and working conditions. The union says a majority of drivers at each of three delivery service partners (DSPs) working out of a Queens warehous…
2                                                                                                                       Amazon has introduced a batch of new generative AI tools that aim to improve the retail experience for both customers and sellers on the platform.
3                                                                                                                                                                                  Save 30% on the Alexa-enabled Amazon Smart Thermostat and transform your energy savings
4  Did you think Amazon Fire tablets were exempt from generative AI tools? Think again. The company just announced a spate of AI-centric features\r\n that are rolling out to the just-announced Fire HD 8 refresh and a bunch of older models.\nNone of these features a…
5     Amazon Prime Big Deal Days is back this year, returning on October 8 and 9. The “fall Prime Day” of sorts has served as the online retailer’s unofficial kickoff to the holiday shopping season for the past few years. We expect most of the deals to be Prime exc…
6     If you have a PC, tablet, gaming handheld in need of a storage boost, Amazon’s latest October Prime Day sale looks to be a solid time to upgrade. The two-day event, which runs through Wednesday, includes a handful of all-time lows (or at least near-lows) on r…
                                                                                                                          url
1                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_e9caf9b2-40e4-4a70-80c0-ad083b83db5f
2                https://www.theverge.com/2024/9/19/24249046/amazon-generative-ai-tools-personalized-shopping-recommendations
3 https://gizmodo.com/amazon-reduced-its-smart-thermostat-pricing-by-35-and-you-can-reduce-your-energy-consumption-2000507616
4                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_4613181c-6b1c-4869-8e46-c1e5d57daee3
5                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_ddd2b4b7-13e0-4387-b32d-e25f5dabcb5b
6                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_727bf966-3cfe-4acf-a0c4-a76b51671acc
                                                                                                                                                                                            urlToImage
1                                                                                                                                                                                                 &lt;NA&gt;
2 https://cdn.vox-cdn.com/thumbor/87pZwBb8drggTN1YEfMBatJzYwk=/0x0:2640x1486/1200x628/filters:focal(1320x743:1321x744)/cdn.vox-cdn.com/uploads/chorus_asset/file/25629756/Amazon_AI_shopping_recs.jpeg
3                                                                                                                                         https://gizmodo.com/app/uploads/2024/10/AmazonThermostat.jpg
4                                                                                                                                                                                                 &lt;NA&gt;
5                                                                                                                                                                                                 &lt;NA&gt;
6                                                                                                                                                                                                 &lt;NA&gt;
           publishedAt
1 2024-09-16T20:27:58Z
2 2024-09-19T16:29:27Z
3 2024-10-04T18:18:55Z
4 2024-10-02T16:48:09Z
5 2024-10-03T17:54:46Z
6 2024-10-08T20:44:28Z
                                                                                                                                                                                                                     content
1      If you click 'Accept all', we and our partners, including 239 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
2 Amazon is stuffing generative AI into its shopping experience\r\nAmazon is stuffing generative AI into its shopping experience\r\n / The retail giant is also releasing an AI video generator for making pr… [+3029 chars]
3     We are now more than a decade into the smart home era of consumer technology. If you have an Amazon Alexa or other branded smart home hub, there’s a lot of cool stuff you can do with routines or just… [+2245 chars]
4      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
5      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
6      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
  source.id         source.name
1      &lt;NA&gt; Yahoo Entertainment
2 the-verge           The Verge
3      &lt;NA&gt;         Gizmodo.com
4      &lt;NA&gt; Yahoo Entertainment
5      &lt;NA&gt; Yahoo Entertainment
6      &lt;NA&gt; Yahoo Entertainment</code></pre>
</div>
</div>
<p>Summary of source.name for tesla_data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>source_summary <span class="ot">&lt;-</span> <span class="fu">table</span>(tesla_data<span class="sc">$</span>source.name)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(source_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                [Removed]              Ars Technica                  BBC News 
                        3                         5                         1 
         Business Insider            Digital Trends               Gizmodo.com 
                       34                         1                        11 
             heise online              Hipertextual Investor's Business Daily 
                        2                        11                         1 
                      NPR                       PBS                 The Verge 
                        1                         1                         6 
                     Time                 USA Today               VentureBeat 
                        2                         1                         1 
                    Wired          WPIX 11 New York                Xataka.com 
                        3                         1                         6 
      Yahoo Entertainment 
                        9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>source_summary_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(source_summary)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(source_summary_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Count"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(source_summary_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Source Count
1                  [Removed]     3
2               Ars Technica     5
3                   BBC News     1
4           Business Insider    34
5             Digital Trends     1
6                Gizmodo.com    11
7               heise online     2
8               Hipertextual    11
9  Investor's Business Daily     1
10                       NPR     1
11                       PBS     1
12                 The Verge     6
13                      Time     2
14                 USA Today     1
15               VentureBeat     1
16                     Wired     3
17          WPIX 11 New York     1
18                Xataka.com     6
19       Yahoo Entertainment     9</code></pre>
</div>
</div>
<p>Converting to dates and sorting on published col.&nbsp;Then creating a new col pub_diff.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>tesla_data_sort <span class="ot">&lt;-</span> tesla_data <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">publishedAt =</span> <span class="fu">ymd_hms</span>(publishedAt)) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(publishedAt) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pub_diff =</span> publishedAt <span class="sc">-</span> <span class="fu">lag</span>(publishedAt))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tesla_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     author
1                      &lt;NA&gt;
2 Kevin Purdy, Ars Technica
3           Aarian Marshall
4         Andrew J. Hawkins
5         Andrew J. Hawkins
6                      &lt;NA&gt;
                                                             title
1                                                        [Removed]
2   I Own a Chevy Bolt, and Superchargers Are a Total Game Changer
3 Tesla Is Ready to Roll Out the Cybercab, Its Answer to Robotaxis
4   Tesla Cybercab announced: Elon Musk’s robotaxi is finally here
5                         The bill finally comes due for Elon Musk
6                                                        [Removed]
                                                                                                                                                                    description
1                                                                                                                                                                     [Removed]
2                                                                   The anxiety of longer trips in my EV has eased considerably now that I can use Tesla Supercharger stations.
3 On Thursday, Tesla will reveal its Cybercab, a self-driving robotaxi. But running an autonomous ride-hailing fleet involves much more than teaching cars to drive themselves.
4                                 Tesla CEO Elon Musk unveiled the long-awaited prototype robotaxi at an event in Los Angeles. But questions remain about the vehicle’s safety.
5                            Tesla CEO Elon Musk is finally forced to stop hiding behind his bluster and show off a real autonomous vehicle. Anything less would be a disaster.
6                                                                                                                                                                     [Removed]
                                                                                                      url
1                                                                                     https://removed.com
2              https://www.wired.com/story/i-own-a-chevy-bolt-and-superchargers-are-a-total-game-changer/
3                               https://www.wired.com/story/tesla-is-ready-to-roll-out-cybercab-robotaxi/
4 https://www.theverge.com/2024/10/10/24265530/tesla-robotaxi-elon-musk-features-range-price-release-date
5   https://www.theverge.com/2024/10/9/24265781/tesla-robotaxi-elon-musk-claims-safety-driverless-level-5
6                                                                                     https://removed.com
                                                                                                                                                                                                   urlToImage
1                                                                                                                                                                                                        &lt;NA&gt;
2                                                                                   https://media.wired.com/photos/67004d2a6602ed7227d3fcae/191:100/w_1280,c_limit/Gear_Chevy_Bolt_GettyImages-1962772373.jpg
3                                                                                           https://media.wired.com/photos/670573800d28edd6a8566d13/191:100/w_1280,c_limit/tesla-cybercab-gear-1167397052.jpg
4              https://cdn.vox-cdn.com/thumbor/fBs9y8RUB3-qwqpgYcORgqbrDfs=/0x0:2560x1440/1200x628/filters:focal(1280x720:1281x721)/cdn.vox-cdn.com/uploads/chorus_asset/file/25670491/videoframe_3297637.png
5 https://cdn.vox-cdn.com/thumbor/UTFYAIWx1CsXE6oKzXfSIOu2rXQ=/0x0:2040x1360/1200x628/filters:focal(1020x680:1021x681)/cdn.vox-cdn.com/uploads/chorus_asset/file/25663397/STKE001_STK086_Tesla_Robotaxi_D.jpg
6                                                                                                                                                                                                        &lt;NA&gt;
           publishedAt
1 2024-10-02T21:27:56Z
2 2024-10-04T22:04:17Z
3 2024-10-09T12:30:00Z
4 2024-10-11T02:59:05Z
5 2024-10-09T14:38:07Z
6 2024-10-08T19:10:25Z
                                                                                                                                                                                                                        content
1                                                                                                                                                                                                                     [Removed]
2      It should not be so exciting to eat a breakfast quesadilla in your car.\r\nBut this quesadilla was from Wawa, this Wawa hosted a Tesla Supercharger, and this car was the 2023 Chevrolet Bolt EUV, hooked… [+6109 chars]
3        On Thursday evening, around 7 pm PDT, Tesla is slated to unveil the newest vehicle in its lineup: one that will be able to drive itself. A purpose-built Tesla robot taxia Cybercab, in the electric au… [+2713 chars]
4    Tesla Cybercab announced: Elon Musks robotaxi is finally here\r\nTesla Cybercab announced: Elon Musks robotaxi is finally here\r\n / Musk showed off a prototype of a self-driving car he calls the Cyberca… [+3285 chars]
5 Image: Cath Virginia / The Verge, Turbosquid\r\n\n \n\n\n The Tesla CEO has long promised — and failed to deliver —&nbsp;a fully autonomous vehicle. With this week’s robotaxi reveal, his time is up. For almost … [+16028 chars]
6                                                                                                                                                                                                                     [Removed]
  source.id source.name
1      &lt;NA&gt;   [Removed]
2     wired       Wired
3     wired       Wired
4 the-verge   The Verge
5 the-verge   The Verge
6      &lt;NA&gt;   [Removed]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>amazon_data_sort <span class="ot">&lt;-</span> amazon_data <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">publishedAt =</span> <span class="fu">ymd_hms</span>(publishedAt)) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(publishedAt) <span class="sc">|&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pub_diff =</span> publishedAt <span class="sc">-</span> <span class="fu">lag</span>(publishedAt))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(amazon_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               author
1           Kris Holt
2     Jess Weatherbed
3         Joe Tilleli
4       Lawrence Bonk
5 Valentina Palladino
6           Jeff Dunn
                                                                                       title
1                                 Hundreds of Amazon drivers in NYC join the Teamsters union
2                              Amazon is stuffing generative AI into its shopping experience
3 Reduce Energy and Money with Amazon Smart Thermostat Now That 30% Off for Amazon Prime Day
4   Amazon tablets are getting AI tools, like writing assist and automatic website summaries
5                 The best early Amazon Prime Day deals to shop before October Big Deal Days
6           These Prime Day SSD deals are the best we found for Amazon October Big Deal Days
                                                                                                                                                                                                                                                               description
1 Hundreds of Amazon\r\n drivers in New York City have joined the Teamsters\r\n union in the hope of obtaining better pay and working conditions. The union says a majority of drivers at each of three delivery service partners (DSPs) working out of a Queens warehous…
2                                                                                                                       Amazon has introduced a batch of new generative AI tools that aim to improve the retail experience for both customers and sellers on the platform.
3                                                                                                                                                                                  Save 30% on the Alexa-enabled Amazon Smart Thermostat and transform your energy savings
4  Did you think Amazon Fire tablets were exempt from generative AI tools? Think again. The company just announced a spate of AI-centric features\r\n that are rolling out to the just-announced Fire HD 8 refresh and a bunch of older models.\nNone of these features a…
5     Amazon Prime Big Deal Days is back this year, returning on October 8 and 9. The “fall Prime Day” of sorts has served as the online retailer’s unofficial kickoff to the holiday shopping season for the past few years. We expect most of the deals to be Prime exc…
6     If you have a PC, tablet, gaming handheld in need of a storage boost, Amazon’s latest October Prime Day sale looks to be a solid time to upgrade. The two-day event, which runs through Wednesday, includes a handful of all-time lows (or at least near-lows) on r…
                                                                                                                          url
1                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_e9caf9b2-40e4-4a70-80c0-ad083b83db5f
2                https://www.theverge.com/2024/9/19/24249046/amazon-generative-ai-tools-personalized-shopping-recommendations
3 https://gizmodo.com/amazon-reduced-its-smart-thermostat-pricing-by-35-and-you-can-reduce-your-energy-consumption-2000507616
4                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_4613181c-6b1c-4869-8e46-c1e5d57daee3
5                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_ddd2b4b7-13e0-4387-b32d-e25f5dabcb5b
6                     https://consent.yahoo.com/v2/collectConsent?sessionId=1_cc-session_727bf966-3cfe-4acf-a0c4-a76b51671acc
                                                                                                                                                                                            urlToImage
1                                                                                                                                                                                                 &lt;NA&gt;
2 https://cdn.vox-cdn.com/thumbor/87pZwBb8drggTN1YEfMBatJzYwk=/0x0:2640x1486/1200x628/filters:focal(1320x743:1321x744)/cdn.vox-cdn.com/uploads/chorus_asset/file/25629756/Amazon_AI_shopping_recs.jpeg
3                                                                                                                                         https://gizmodo.com/app/uploads/2024/10/AmazonThermostat.jpg
4                                                                                                                                                                                                 &lt;NA&gt;
5                                                                                                                                                                                                 &lt;NA&gt;
6                                                                                                                                                                                                 &lt;NA&gt;
           publishedAt
1 2024-09-16T20:27:58Z
2 2024-09-19T16:29:27Z
3 2024-10-04T18:18:55Z
4 2024-10-02T16:48:09Z
5 2024-10-03T17:54:46Z
6 2024-10-08T20:44:28Z
                                                                                                                                                                                                                     content
1      If you click 'Accept all', we and our partners, including 239 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
2 Amazon is stuffing generative AI into its shopping experience\r\nAmazon is stuffing generative AI into its shopping experience\r\n / The retail giant is also releasing an AI video generator for making pr… [+3029 chars]
3     We are now more than a decade into the smart home era of consumer technology. If you have an Amazon Alexa or other branded smart home hub, there’s a lot of cool stuff you can do with routines or just… [+2245 chars]
4      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
5      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
6      If you click 'Accept all', we and our partners, including 240 who are part of the IAB Transparency &amp;amp; Consent Framework, will also store and/or access information on a device (in other words, use … [+678 chars]
  source.id         source.name
1      &lt;NA&gt; Yahoo Entertainment
2 the-verge           The Verge
3      &lt;NA&gt;         Gizmodo.com
4      &lt;NA&gt; Yahoo Entertainment
5      &lt;NA&gt; Yahoo Entertainment
6      &lt;NA&gt; Yahoo Entertainment</code></pre>
</div>
</div>
<p>Creating a subset of the amazon data and using map() to return numeric summaries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>amazon_subset <span class="ot">&lt;-</span> amazon_data_sort<span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(publishedAt, pub_diff)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>num_sum <span class="ot">&lt;-</span> <span class="fu">map</span>(amazon_subset, \(x) {</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>num_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$publishedAt
$publishedAt$mean
[1] "2024-10-04 17:35:15 UTC"

$publishedAt$sd
[1] 531269.3

$publishedAt$median
[1] "2024-10-06 17:30:12 UTC"


$pub_diff
$pub_diff$mean
Time difference of 25228.35 secs

$pub_diff$sd
[1] 47072.68

$pub_diff$median
Time difference of 6985 secs</code></pre>
</div>
</div>
<p>test</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>